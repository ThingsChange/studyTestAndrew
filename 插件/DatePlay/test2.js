(function(m){function x(b,h,t,k,n){n=!1;var e="",f=[],q=!1,r=b.length;if(0<r)for(var c=0;c<r;c++){var g=!1,a="",l=b[c][2],d=B(new Date(b[c][0],b[c][1]-1,l),"yyyyMMdd").substring(0,6);if(-1<m.inArray(d,h)){a:{f=t.length;if(0<f)for(var p=0;p<f;p++)if(d==t[p].month){f=t[p].detail;break a}f=null}0<f.length&&0==k&&(q=!0);if(f&&0<f.length)for(p=0;p<f.length;p++)f[p].date==l&&(f[p].selectedGroup?n=g=!0:g=!1,0<f[p].freeSeat&&9>=f[p].freeSeat?a+='<p class="p_middle">\u4f59:'+f[p].freeSeat+"</p>":0==f[p].freeSeat?
    a+='<p class="p_middle">\u552e\u7f44</p>':9<f[p].freeSeat?a+='<p class="p_middle">\u5145\u8db3</p>':-1==f[p].freeSeat&&(a+='<p class="p_middle">\u73b0\u8be2</p>'),a+='<p class="p_bottom">'+f[p].groupPrice+"</p>")}f=a?g?'<div class="divChild_absolute border_orange"></div></div>':'<div class="divChild_absolute border_gray "></div></div>':'<div class="divChild_absolute "></div></div>';-1==k?e+='<div class="divChild dc_2 otherMonth"><p class="p_top">'+l+"</p>"+a+f:0==k?e=g?e+('<div class="divChild dc_2 background_orange"><p class="p_top">'+
l+"</p>"+a+f):e+('<div class="divChild dc_2"><p class="p_top">'+l+"</p>"+a+f):1==k&&(e+='<div class="divChild dc_2 otherMonth"><p class="p_top">'+l+"</p>"+a+f)}a="";h=b[0][0];b=b[0][1];0==k&&(q?(a=(n?a+("<div id="+d+' class="date_top_use active">'):a+("<div id="+d+' class="date_top_use">'))+("<div>"+h+"\u5e74"+Number(b)+"\u6708</div>"),a+="<div></div></div>"):(a+="<div id="+d+'  class="date_top_use">',a+="<div>"+h+"\u5e74"+Number(b)+"\u6708</div>",a+="<div>\u65e0\u56e2\u671f</div></div>"));m(".date_top_center").append(a);
    return e}function B(b,h){var m=function(b){return(b+"").replace(/^(\d)$/,"0$1")},k={yyyy:b.getFullYear(),yy:b.getFullYear().toString().substring(2),M:b.getMonth()+1,MM:m(b.getMonth()+1),d:b.getDate(),dd:m(b.getDate()),hh:b.getHours(),mm:b.getMinutes(),ss:b.getSeconds()};h||(h="yyyy-MM-dd hh:mm:ss");return h.replace(/([a-z])(\1)*/ig,function(b){return k[b]})}function u(b){if(b)var h=sessionStorage.getItem(b);m("#divParent>.divChild.dc_2").remove();m("#divParent").append(h)}Array.prototype.indexOf||
(Array.prototype.indexOf=function(b,h){var m=this.length>>>0,k=Number(h)||0,k=0>k?Math.ceil(k):Math.floor(k);for(0>k&&(k+=m);k<m;k++)if(k in this&&this[k]===b)return k;return-1});sessionStorage.setItem("groupDate",JSON.stringify([{proOrGroup:1,month:"201612",detail:[{date:"30",groupPrice:"\uffe51234",freeSeat:-1,selectedGroup:""},{date:"25",groupPrice:"\uffe52345",freeSeat:0,selectedGroup:""}]},{proOrGroup:1,month:"201611",detail:[{date:"30",groupPrice:"\uffe53523",freeSeat:-1,selectedGroup:""},{date:"25",
    groupPrice:"\uffe52345",freeSeat:0,selectedGroup:""}]},{proOrGroup:0,month:"201701",detail:[{date:"30",groupPrice:"\uffe514",freeSeat:12,selectedGroup:""},{date:"1",groupPrice:"\uffe520",freeSeat:0,selectedGroup:""}]},{proOrGroup:1,month:"201605",detail:[{date:"12",groupPrice:"\uffe5122334",freeSeat:-1,selectedGroup:""},{date:"15",groupPrice:"\uffe523445",freeSeat:0,selectedGroup:"1"}]},{proOrGroup:1,month:"201604",detail:[{date:"28",groupPrice:"\uffe51234",freeSeat:-1,selectedGroup:""},{date:"23",
    groupPrice:"\uffe52345",freeSeat:0,selectedGroup:""}]}]));sessionStorage.setItem("startToEnd",JSON.stringify({startMonth:{year:"201612"},endMonth:{year:"201712"}}));var z=sessionStorage.getItem("groupDate"),C=sessionStorage.getItem("startToEnd");JSON.parse(C);(function(b,h,t,k,n,e){n=Number(h.substring(0,4));var f=Number(h.substring(5,7));h=Number(b.substring(0,4));e=Number(b.substring(5,7));b=[];var f=12*(n-h)+f-e+1,q=0;for(n=e;n<f+e;n++)1<n&&1==n%12&&q++,b.push(h+1*q+"-"+(2==((0==n%12?12:n%12)+
    "").length?0==n%12?12:n%12:"0"+(0==n%12?12:n%12))+"-01");h=b.length;if(0<h)for(n=0;n<h;n++){f=t;e=k;e=z;var r=b[n],q=Number(r.substring(0,4)),c=Number(r.substring(5,7)),r=c,g,a=q;g=[];for(var l=(new Date(a,c,0)).getDate(),d=1;d<=l;d++)g.push([a,c,d]);c=[];l=[];for(d=-1;0<g.length;)a=g.shift(),l.push(a),a=(new Date(a[0],a[1]-1,a[2])).getDay(),d==a?a=0:6==a&&(c.push(l),l=[]),d=a;l.length&&c.push(l);d=c[0];if(7>d.length)for(;7>d.length;)g=d[0],a=new Date(g[0],g[1]-1,g[2]-1),d.unshift([a.getFullYear(),
    a.getMonth()+1,a.getDate()]);else{g=d[0];l=[];for(d=1;7>=d;d++)a=new Date(g[0],g[1]-1,g[2]-d),l.unshift([a.getFullYear(),a.getMonth()+1,a.getDate()]);c.unshift(l)}for(d=c[c.length-1];7>d.length;)g=d[d.length-1],a=new Date(g[0],g[1]-1,g[2]+1),d.push([a.getFullYear(),a.getMonth()+1,a.getDate()]);if(6>c.length){g=d[d.length-1];l=[];for(d=1;7>=d;d++)a=new Date(g[0],g[1]-1,g[2]+d),l.push([a.getFullYear(),a.getMonth()+1,a.getDate()]);c.push(l)}g=c;for(var d=[],a=[],l=[],p={lastMonth:"",nowMonth:"",nextMonth:""},
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          u=0;u<g.length;u++)for(var A=g[u],y=0;y<A.length;y++){var c=r,v=A[y],w=v[1];q>v[0]?c+=12:q<v[0]&&(w+=12);c>w?d.push(v):c==w?a.push(v):c<w&&l.push(v)}p.lastMonth=d;p.nowMonth=a;p.nextMonth=l;q=p;e=JSON.parse(e);r=[];c=0;for(g=e.length;c<g;c++)0<e.length&&-1==r.indexOf(e[c].month)&&r.push(e[c].month);c="";c=x(q.lastMonth,r,e,"-1");g=x(q.nowMonth,r,e,"0",f);e=x(q.nextMonth,r,e,"1");c=c+g+e;e=q.nowMonth[0][1];e=q.nowMonth[0][0]+(2==(e+"").length?e+"":"0"+e);f=f?f.substring(0,4)+f.substring(5,7):"";sessionStorage.setItem(e,
    c);e=f==e?c:"";m("#divParent").append(e)}t=m("div.date_top_use.active").prevAll();k=m("div.date_top_use.active").nextAll();2<=t.length&&t.eq("1").prevAll().addClass("top_hide");2<=k.length&&k.eq("1").nextAll().addClass("top_hide")})("2016-01-17","2016-06-01","2016-05-25",z);m(".date_top_left").bind("click",function(){var b=m(".date_top_center>.date_top_use.active");if(0!=b.prev().length){var h=b.next().next().next().next();h.is(".top_hide")||(h.addClass("top_hide"),b.prev().removeClass("top_hide"));
    b.removeClass("active").prev().addClass("active");u(b.attr("id"))}});m(".date_top_right").bind("click",function(){var b=m(".date_top_center>.date_top_use.active");if(0!=b.next().length){var h=b.prev().prev().prev().prev();h.is(".top_hide")||(h.addClass("top_hide"),b.next().removeClass("top_hide"));b.removeClass("active").next().addClass("active");u(b.attr("id"))}});m(".date_top_use").bind("click",function(){m(this).siblings().removeClass("active");m(this).addClass("active");u(m(this).attr("id"))})})(jQuery);